build:
  template_file: simple-task.tyml
  dependencies:
    # Make sure builds are ready
    # - "linux-arm64-cpu-opt" Aarch64 packages are refused by upload.pypi.org
    - "darwin-amd64-cpu-opt"
    - "darwin-amd64-tflite-opt"
    - "linux-amd64-cpu-opt"
    - "linux-amd64-tflite-opt"
    - "linux-amd64-gpu-opt"
    - "linux-rpi3-cpu-opt"
    - "win-amd64-cpu-opt"
    - "win-amd64-gpu-opt"
  allowed:
    - "tag"
  ref_match: "refs/tags/"
  routes:
    - "notify.irc-channel.${notifications.irc}.on-exception"
    - "notify.irc-channel.${notifications.irc}.on-failed"
  upload_targets:
    - "pypi"
  artifacts_deps:
    javascript: []
    cpp: []
    java_aar: []
    python:
      - "darwin-amd64-cpu-opt"
      - "darwin-amd64-tflite-opt"
      - "linux-amd64-cpu-opt"
      - "linux-amd64-tflite-opt"
      - "linux-amd64-gpu-opt"
      - "linux-rpi3-cpu-opt"
      - "win-amd64-cpu-opt"
      - "win-amd64-gpu-opt"
      # - "linux-arm64-cpu-opt" Aarch64 packages are refused by upload.pypi.org
    nuget: []
  metadata:
    name: "DeepSpeech PyPi Packages"
    description: "Trigger Uploading of DeepSpeech Packages to PyPi"
